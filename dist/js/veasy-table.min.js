"use strict";angular.module("veasy.table",["ngSanitize","veasy.table.templates"]);
angular.module("veasy.table").filter("vtUrl",["$sanitize",function(t){return function(e,r,a){return t('<a target="'+a+'" href="'+e+'">'+e+"</a>")}}]);
angular.module("veasy.table").service("vtCheckboxService",["$timeout",function(e){var n=function(e){for(var n=[],t=0;t<e.length;t++)for(var r=0;r<e[t].length;r++)n[t]=[],n[t][r]=!1;return n},t=function(e,n){var t=[];return angular.forEach(e,function(e,r){angular.forEach(e,function(e,a){e&&t.push(n[r][a])})}),t},r=function(e,n,t){var r=!1,u=!1;return angular.forEach(n[t],function(e,n){e?r=!0:u=!0}),a(e,r,u)},a=function(e,n,t){return n&&t?(u(e,!0),!1):n?(u(e,!1),!0):t?(u(e,!1),!1):void 0},u=function(e,n){angular.element(e).prop("indeterminate",n)};return{reset:n,defineCheckboxMasterState:r,defineCheckboxState:a,getSelectedItems:t}}]);
angular.module("veasy.table").service("vtColumnService",[function(){var e=function(e){if(e)return e.some(function(e){return e.isHidden})},n=function(e,n,i,r,o){e.splice(n,0,{rowIndex:n,isToggleable:!0})},i=function(e,n){e.splice(n,1)},r=function(e){if(e)return e.filter(function(e){return e.isToggleable})},o=function(e,n){var o=r(e);if(o)for(var t=0;t<o.length;t++)o[t].rowIndex!==n&&i(e,e.indexOf(o[t]))},t=function(e){var n=e.filter(function(e){return!e.isHidden})||[];return n.length+1},u=function(e,n){var i=[];return n.forEach(function(n){n.isHidden&&i.push({header:n.header,value:e[n.value],filter:n.filter})}),i};return{openRow:n,closeRow:i,closeAllOpenedRows:o,haveHiddenColumn:e,defineToggleRowColspan:t,getHiddenContent:u}}]);
angular.module("veasy.table").service("vtConfigService",[function(){var n=function(n){return n||(n={}),n.columns||(n.columns=[]),n.id=e(n.id),n.toggleColumns=t(n.toggleColumns),n.checkbox=a(n.checkbox),n.sort=l(n.sort),n.pagination=i(n.pagination),n.filter=r(n.filter),n.columnFilter=c(n.columnFilter),n.labels=s(n.labels),n},e=function(n){return n||(n=o()),n},o=function(){var n=Math.round(4*Math.random()*1e5),e="veasy-table-"+n,t=angular.element("table#"+e);return t&&t.length>0&&o(),e},t=function(n){return n||(n={}),n.enable||(n.enable=!1),n.position||(n.position=!1),n.icons||(n.icons={}),n.icons.opened||(n.icons.opened="fa fa-chevron-down"),n.icons.closed||(n.icons.closed="fa fa-chevron-left"),n},a=function(n){return n||(n={}),n.enable||(n.enable=!1),n},l=function(n){return n||(n={}),n.enable||(n.enable=!1),n},i=function(n){return n||(n={}),n.enable||(n.enable=!1),n.currentPage||(n.currentPage=0),n.itemsPerPage||(n.itemsPerPage=10),n},r=function(n){return n||(n={}),n.enable||(n.enable=!1),n.conditional||(n.conditional=!1),n.delay||(n.delay=500),n},c=function(n){return n||(n={}),n.enable||(n.enable=!1),n.modalOptions||(n.modalOptions={}),n.modalOptions.size||(n.modalOptions.size="md"),n.modalOptions.autoOpen||(n.modalOptions.autoOpen=!1),n.modalOptions.keyboard||(n.modalOptions.keyboard=!0),n.modalOptions.backdrop||(n.modalOptions.backdrop=!0),n},s=function(n){return n||(n={}),n.filter||(n.filter={}),n.filter.by||(n.filter.by="Filter by..."),n.filter.all||(n.filter.all="All"),n.filter.and||(n.filter.and="AND"),n.filter.or||(n.filter.or="OR"),n.pagination||(n.pagination={}),n.pagination.itemsPerPage||(n.pagination.itemsPerPage="Items by Page"),n.pagination.totalItems||(n.pagination.totalItems="Total of Items"),n.modal||(n.modal={}),n.modal.title||(n.modal.title="Which columns you want to display?"),n.modal.okButton||(n.modal.okButton="Apply"),n.modal.cancelButton||(n.modal.cancelButton="Cancel"),n};return{validate:n}}]);
angular.module("veasy.table").service("vtModalService",["vtCheckboxService","$timeout",function(e,n){var a=function(e){return e.replace(/veasy-table-/gi,"veasy-table-modal-")},t=function(e,a){var t={};return a.forEach(function(a){var o="#"+e+" input#cbMaster-"+a.value;n(function(){t[a.value]=r(o,a)},0)}),t},r=function(n,a){var t=!1,r=!1;return angular.forEach(a.hideOn,function(e){e?t=!0:r=!0}),e.defineCheckboxState(n,t,r)},o=function(e){return e.map(function(e){var n=e.hideOn.split(" ");return{header:e.header,value:e.value,hideOn:{lg:i(n,"lg"),md:i(n,"md"),sm:i(n,"sm"),xs:i(n,"xs")}}})},i=function(e,n){return e.indexOf(n)===-1},u=function(e,n){var a=angular.copy(e),t={};return n.forEach(function(e){var n="";for(var a in e.hideOn)e.hideOn[a]||(n+=a+" ");t[e.value]=n.trim()}),a.forEach(function(e){e.$$hashKey&&delete e.$$hashKey,e.toggle||(e.hideOn=t[e.value])}),a},l=function(e,n){angular.element("#"+e).modal({keyboard:n.keyboard,backdrop:n.backdrop}),angular.element('[data-toggle="tooltip-screen-size"]').tooltip()},c=function(e){angular.element("#"+e).modal("hide")},d=function(e,n,a,t){var o={};return n.forEach(function(n){n.hideOn[e]=a;var i="#"+t+" input#cbMaster-"+n.value;o[n.value]=r(i,n)}),o};return{getModalId:a,initMasterCheckbox:t,defineMasterCheckboxState:r,updateColumnsVisibility:u,checkAllByScreenSize:d,getColumns:o,openModal:l,closeModal:c}}]);
angular.module("veasy.table").service("vtPaginationService",[function(){var r=function(r){return!isNaN(r)&&isFinite(r)},n=function(n,t){if(!n)return[];for(var a=[],e=0;e<n.length;e++){var i=e/t;r(i)&&(e%t===0?a[Math.floor(i)]=[n[e]]:a[Math.floor(i)].push(n[e]))}return a},t=function(r,n,t){n>r-t&&(n=r-t+1);for(var a=[],e=n;e<n+t;e++)e>=0&&a.push(e);return a};return{paginate:n,pages:t}}]);
angular.module("veasy.table").service("vtScreenService",["$window",function(e){var i=function(i){var t=angular.element("div > #"+i).parent(),a=e.screen;return o()?{width:a.width,height:a.height}:{width:t.width(),height:t.height()}},t=function(e){var t=(i(e),angular.element("table#"+e)),a=t.offset();return a?{width:t.width(),height:t.height(),offset:{top:t.offset().top,left:t.offset().left}}:{width:t.width(),height:t.height()}},a=function(e){var a=t(e),o=i(e);return a.width>o.width},o=function(){var e=!1;return function(i,t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},n=function(){var i=o()?e.screen.width:angular.element("body").width();return i<768?"xs":i>=768&&i<992?"sm":i>=992&&i<1200?"md":i>=1200?"lg":void 0},r=function(e){return!(!e||e.indexOf(n())===-1)};return{screenSize:n,veasyTable:t,isBrokenLayout:a,isNeedToHide:r}}]);
angular.module("veasy.table").service("vtSearchService",["$filter",function(e){var r=function(e,r){var n=[],t={};return e.forEach(function(e,r){e.toggle||(n.push(e),t[e.value]=e.filter)}),n.unshift({header:r.filter.all,value:"all",filters:t}),n},n=function(r,n,i,o){var f=r.split(" ");return e("filter")(o,function(e){return"AND"===n?t(f,a(i,e)):"OR"===n?u(f,a(i,e)):void 0})},t=function(e,r){return e.every(function(e){return r.toString().indexOf(e)!==-1})},u=function(e,r){return e.some(function(e){return r.toString().indexOf(e)!==-1})},i=function(r,n){var t=n?n.type:"";return"date"===t?e("date")(r,n.format,n.timezone):"currency"===t?e("currency")(r,n.symbol,n.fractionSize):"number"===t?e("number")(r,n.fractionSize):r},a=function(e,r){return r.$$hashKey&&delete r.$$hashKey,"all"===e.value?o(e,r):i(r[e.value]||"",e.filter)},o=function(e,r){var n="";for(var t in r)n+=i(r[t]||"",e.filters[t])+" ";return n};return{getColumnsDropdown:r,search:n}}]);
angular.module("veasy.table").service("vtService",["$window",function(e){return{}}]);
angular.module("veasy.table").directive("veasyTable",["$templateCache","$window","$filter","$timeout","vtScreenService","vtPaginationService","vtSearchService","vtCheckboxService","vtColumnService","vtConfigService","vtModalService",function(e,n,t,o,i,a,c,r,l,s,u){return{restrict:"E",replace:!0,templateUrl:"template.html",scope:{config:"=",list:"="},link:function(e,d,g,f){var p=function(){e.config=s.validate(e.config),e.vetModalId=u.getModalId(e.config.id),e.filterColumnsList=c.getColumnsDropdown(e.config.columns,e.config.labels),e.selectedColumn=e.filterColumnsList[0],e.condition="AND",e.searching=!1,e.master={checkbox:!1,expanded:!1},e.checkboxes=[],e.expanded=[],e.resultList=[],h(),m(e.config),x()},m=function(n){n.toggleColumns.enable&&$(e.config),n.columnFilter.enable&&n.columnFilter.modalOptions.autoOpen&&o(function(){e.openColumnFilterModal(n.columns)},0)},h=function(){e.$watch("list",function(n){n&&(e.resultList=angular.copy(n),e.filteredList=angular.copy(n),S(e.filteredList,e.config.pagination.itemsPerPage,0),v("resize"))}),e.$watch("config.columns",function(e){e&&v("resize")},!0),n.addEventListener("resize",function(){e.updatingTableColumns=!0,e.outOfBound=!1,e.$apply(function(){o(function(){i.isBrokenLayout(e.config.id)&&(e.outOfBound=!0),x(),L(),o(function(){e.updatingTableColumns=!1},500)},0)})})},v=function(e){o(function(){n.dispatchEvent(new Event(e))},0)};e.getTBodyStyle=function(){var n=angular.element("table#"+e.config.id),t={};return n&&(t.width=n.width()?n.width()+"px":"0px",t.height=n.height()?n.height()+"px":"0px",n.position()&&(t.top=n.position().top?n.position().top+"px":"0px",t.left=n.position().left?n.position().left+"px":"0px")),t};var x=function(){e.toggleRowColspan=l.defineToggleRowColspan(e.config.columns),l.closeAllOpenedRows(e.resultList)};e.openColumnFilterModal=function(n){e.modalColumns=u.getColumns(n),e.modalCheckboxMaster=u.initMasterCheckbox(e.vetModalId,e.modalColumns),u.openModal(e.vetModalId,e.config.columnFilter.modalOptions)},e.checkWindowSize=function(n){var t="#"+e.vetModalId+" input#cbMaster-"+n.value;e.modalCheckboxMaster[n.value]=u.defineMasterCheckboxState(t,n)},e.checkWindowSizeMaster=function(e,n){for(var t in e.hideOn)e.hideOn[t]=n},e.checkAllByScreenSize=function(n,t,o){e.screenSize||(e.screenSize={}),e.screenSize[n]=!o,e.modalCheckboxMaster=u.checkAllByScreenSize(n,t,e.screenSize[n],e.vetModalId)},e.onConfirmColumnFilterModal=function(n){e.config.columns=u.updateColumnsVisibility(e.config.columns,n),delete e.modalColumns,u.closeModal(e.vetModalId),e.$emit("veasyTable:onApplyColumnFilter",angular.copy(e.config.columns))},e.onClickRow=function(n){var t=angular.copy(n);delete t.$$hashKey,e.$emit("veasyTable:onClickRow",t)},e.checkAllPageRows=function(n,t){e.checkboxes[n]||(e.checkboxes[n]={});for(var o=0;o<e.checkboxes[n].length;o++)e.checkboxes[n][o]=t;C()},e.checkRow=function(n,t,o){n.stopPropagation(),e.checkboxes[t]||(e.checkboxes[t]={}),e.checkboxes[t][o]||(e.checkboxes[t][o]=!!e.checkboxes[t][o]),y(t),C()};var C=function(){e.$emit("veasyTable:selectedItems",r.getSelectedItems(e.checkboxes,e.paginatedList))},b=function(n){e.checkboxes=r.reset(n),C()},y=function(n){var t="#"+e.config.id+" input#checkbox-master";e.master.checkbox=r.defineCheckboxMasterState(t,e.checkboxes,n)};e.sort=function(n){if(e.$emit("veasyTable:onStartSort"),e.predicate===n&&(e.reverse=!e.reverse),e.predicate=n,""!==e.predicate){var o=t("orderBy")(e.filteredList,e.predicate,e.reverse);S(o,e.config.pagination.itemsPerPage,0)}e.$emit("veasyTable:onEndSort")},e.defineSortableIcon=function(e,n){return{"fa-sort":P("",n),"fa-sort-asc":P("asc",n),"fa-sort-desc":P("desc",n)}};var P=function(n,t){return"asc"===n?e.predicate===t&&!e.reverse:"desc"!==n||e.predicate===t&&e.reverse};e.selectFilterColumn=function(n,t,o){e.selectedColumn=o,n&&e.search(n,t,o)},e.changeSearchCondition=function(n,t,o){e.condition=t,n&&e.search(n,t,o)},e.search=function(n,t,i){t&&i&&(e.queryBusy&&o.cancel(e.queryBusy),e.searching=!0,e.$emit("veasyTable:onStartSearch"),e.queryBusy=o(function(){e.filteredList=c.search(n||"",t,i,e.resultList),S(e.filteredList,e.config.pagination.itemsPerPage,0),e.searching=!1,e.$emit("veasyTable:onEndSearch")},e.config.filter.delay))},e.isUrl=function(e){return"url"===e.filter.type},e.applyFilter=function(e,n){return"currency"===n.type?t("currency")(e,n.symbol,n.fractionSize):"date"===n.type?t("date")(e,n.format,n.timezone):"json"===n.type?t("json")(e,n.spacing):"url"===n.type?t("vtUrl")(e,n.text,n.target):"number"===n.type?t("number")(e,n.fractionSize):"limitTo"===n.type?t("limitTo")(e,n.limit,n.begin):"lowercase"===n.type?t("lowercase")(e):"uppercase"===n.type?t("uppercase")(e):e},e.changeItemsPerPage=function(n){S(e.filteredList,n,0)},e.setPage=function(n){e.currentPage=n,e.pages=a.pages(e.paginatedList.length-1,n,5),e.expanded=[],e.master.expanded=!1,k(),y(e.currentPage)},e.nextPage=function(){e.currentPage<e.paginatedList.length-1&&e.setPage(e.currentPage+1)},e.previousPage=function(){e.currentPage>0&&e.setPage(e.currentPage-1)},e.isNextPageDisabled=function(n){if(n)return e.currentPage===n.length-1},e.isPreviousPageDisabled=function(){return 0===e.currentPage};var S=function(n,t,o){return e.config.pagination.enable?(e.$emit("veasyTable:onStartPagination"),e.paginatedList=a.paginate(n,t),e.setPage(o),b(e.paginatedList),void e.$emit("veasyTable:onEndPagination")):(e.paginatedList=[n],void(e.currentPage=0))},k=function(){e.hiddenContent||(e.hiddenContent=[]),e.hiddenContent[e.currentPage||0]||(e.hiddenContent[e.currentPage||0]=[])},w=function(n,t){k(),e.hiddenContent[e.currentPage][n]=l.getHiddenContent(t,e.config.columns)},L=function(){if(e.paginatedList&&e.paginatedList[e.currentPage])for(var n=0;n<e.paginatedList[e.currentPage].length;n++)w(n,e.paginatedList[e.currentPage][n])};e.initToggleButton=function(n,t){e.expanded[n]=!1,w(n,t)},e.toggleRow=function(n,t,o){n.stopPropagation(),e.expanded[t]=!e.expanded[t]},e.showToggleIcon=function(n){return e.config.toggleColumns&&e.config.toggleColumns.enable&&n.toggle&&e.haveHiddenColumn(e.config.columns)},e.toggleAllRows=function(){e.master.expanded=!e.master.expanded,e.master.expanded?M():T()};var M=function(){for(var n=0;n<e.expanded.length;n++)e.expanded[n]=!0},T=function(){for(var n=0;n<e.expanded.length;n++)e.expanded[n]=!1};e.showToggleHeader=function(n){return!n.toggle||n.toggle&&e.haveHiddenColumn(e.config.columns)},e.haveHiddenColumn=function(e){return l.haveHiddenColumn(e)},e.getToggleIconClasses=function(e,n,t){var o={};return o[e.toggleColumns.icons.closed]=t,o[e.toggleColumns.icons.opened]=n,o};var $=function(e){"begin"===e.toggleColumns.position?e.columns.unshift({header:"",value:"toggle",hideOn:"",toggle:!0}):e.columns.push({header:"",value:"toggle",hideOn:"",toggle:!0})};e.getColumnStyle=function(n){return n.toggle?{width:"37px","text-align":"center"}:e.outOfBound?{"max-width":"1px","min-width":"1px"}:{}};e.responsiveHiddenContentStyle=function(){var e=i.screenSize();return"lg"===e?{"max-width":"1060px"}:"md"===e?{"max-width":"860px"}:"sm"===e?{"max-width":"660px"}:"xs"===e?{"max-width":"260px"}:{}},e.hideColumnOn=function(e,n){return i.isNeedToHide(n)?(e.isHidden=!0,!0):(delete e.isHidden,!1)},p()}}}]);